# 15分鐘虛擬貨幣超短線交易策略

**多層級確認系統 | 風險損益比1:1.5 | 目標夏普比率≈1.0**

## 概述

這是一套完整的TradingView Pine Script交易策略，專為15分鐘K線虛擬貨幣超短線交易設計。透過三層級多指標確認系統，平衡追求高勝率與避免假信號之間的矛盾。

### 核心特性

✅ **三層級確認體系**
- 第一層：趨勢確認（MA多頭/空頭排列）
- 第二層：動能確認（MACD + RSI）
- 第三層：量能確認（成交量 + 型態）

✅ **風險管理**
- 精確的ATR倍數止損
- 1:1.5風險損益比
- 動態調整的倉位大小
- 連虧停止交易機制

✅ **假信號過濾**
- 支撐/阻力位置驗證
- 背離信號識別
- K線型態確認
- 成交量異常檢測

## 文件結構

```
crypto-15m-trading-strategy/
├── strategies/
│   ├── crypto_15m_strategy_v1.0.pine          # 核心版本（推薦新手）
│   └── crypto_15m_strategy_v2.0_advanced.pine # 高級版本（背離+型態）
├── docs/
│   ├── strategy_theory.md                     # 策略理論詳解
│   ├── parameter_tuning.md                    # 參數優化指南
│   └── trading_rules.md                       # 交易執行規則
├── backtests/
│   └── performance_metrics.csv                # 回測性能數據
└── README.md
```

## 快速開始

### 1. 複製策略代碼

#### 版本選擇

- **v1.0（推薦新手）**：核心三層確認系統，簡潔高效
  - 指標：MA + MACD + RSI + ATR + 成交量
  - 適合：快速上手、穩定回測

- **v2.0（進階交易者）**：加入背離+型態識別
  - 新增：背離檢測、錘子線、吞沒形態、成交量尖峰
  - 適合：精細調優、高勝率追求

### 2. 在TradingView導入

1. 打開TradingView → 圖表 → Pine Editor
2. 點擊 "New" → 複製完整代碼
3. 修改策略名稱
4. 按 "Add to Chart"

### 3. 配置參數

#### 基本參數（必須設定）

| 參數 | 預設值 | 說明 | 調整建議 |
|------|-------|------|--------|
| 初始資金 | $1000 | 回測起始資金 | 根據實際帳戶調整 |
| 單筆風險% | 2.0% | 每筆交易的最大虧損 | 保守：1% / 激進：3% |
| 風險損益比 | 1.5 | 目標獲利/虧損比 | 必須≥1.0，推薦1.5-2.0 |

#### 均線參數

| 參數 | 預設值 | 說明 |
|------|-------|------|
| 快速MA | 5 | 超短線反應，不建議改 |
| 中速MA | 20 | 短期趨勢參考 |
| 慢速MA | 60 | 長期趨勢基準 |

#### MACD/RSI參數

| 參數 | 預設值 | 說明 |
|------|-------|------|
| MACD(12,26,9) | 標準 | 不建議改動 |
| RSI(14) | 14期 | 業界標準 |
| RSI超買 | 70 | 通常70以上過熱 |
| RSI超賣 | 30 | 通常30以下過冷 |

#### ATR參數（風險關鍵）

| 參數 | 預設值 | 說明 | 調整範圍 |
|------|-------|------|--------|
| ATR週期 | 14期 | 波動率基準 | 10-20都可接受 |
| 止損倍數 | 2.0倍 | ATR×2.0=止損距離 | 穩健：2.0-2.5 |
| 止盈倍數 | 3.0倍 | ATR×3.0=止盈距離 | 保持1.5的風損比 |

**風損比計算**：
```
止盈距離 = ATR × 3.0 = ATR × 2.0 × 1.5 = 止損距離 × 1.5 ✓
```

#### 過濾參數

| 參數 | 預設值 | 說明 |
|------|-------|------|
| 最小成交量倍數 | 1.5 | 成交量需>平均值150% |
| ATR波動率過濾 | 啟用 | 只在正常波動下交易 |
| 背離信號 | 可選 | 激進→關閉 / 保守→啟用 |
| 二次測試 | 可選 | 激進→關閉 / 保守→啟用 |

## 策略邏輯詳解

### 買入信號（多頭進場）

```mermaid
買入條件
├─ 第一層：5MA > 20MA > 60MA（多頭排列）✓
├─ 第二層：(MACD金叉 OR RSI穿50) AND 動能向上 ✓
├─ 第三層：成交量 > 20MA×1.5 ✓
└─ 進場：所有條件滿足時開倉
```

### 賣出信號（空頭進場）

```mermaid
賣出條件
├─ 第一層：5MA < 20MA < 60MA（空頭排列）✓
├─ 第二層：(MACD死叉 OR RSI穿50下) AND 動能向下 ✓
├─ 第三層：成交量 > 20MA×1.5 ✓
└─ 進場：所有條件滿足時開倉
```

### 止損與止盈

```
進場點：$50,000
ATR值：$50

止損點 = $50,000 - ($50 × 2.0) = $49,900
止盈點 = $50,000 + ($50 × 3.0) = $50,150

風險額度 = $100
預期利潤 = $150
風險損益比 = 150/100 = 1.5 ✓
```

## 回測與優化

### 推薦回測配置

1. **交易品種**
   - 推薦：BTC/USDT, ETH/USDT, SOL/USDT（高流動性）
   - 時間框架：15分鐘K線
   - 回測週期：至少3個月連續數據

2. **回測設定**
   - 佣金：0.05%-0.1%（交易所實際佣金）
   - 滑點：0.02%-0.05%（虛擬貨幣市場現實滑點）
   - 初始資金：$1000-$5000

3. **績效指標目標**

| 指標 | 目標 | 說明 |
|------|------|------|
| 勝率 | 55-65% | 太高(>70%)通常過度擬合 |
| 夏普比 | ≥0.8 | 目標1.0 |
| 獲利因子 | ≥1.5 | 總利潤/總虧損 |
| 最大拉回 | <20% | 單次最大虧損幅度 |
| 盈利交易 | ≥55% | 至少超過一半 |

### 參數優化指南

#### 優化情景1：勝率過低(<50%)

**診斷**：信號太激進，假信號太多

**調整方案**：
- 提高最小成交量倍數：1.5 → 2.0
- 啟用背離確認（v2.0）
- 啟用二次測試過濾
- 提升RSI門檻：從穿50改為穿60

#### 優化情景2：信號太稀少(<10/月)

**診斷**：過濾條件太嚴格

**調整方案**：
- 降低最小成交量倍數：1.5 → 1.2
- 關閉非必須過濾（二次測試）
- 改用簡化的MACD條件
- 放寬ATR波動率門檻

#### 優化情景3：虧損連續(>3筆)

**診斷**：可能進入盤整期，或參數不適應市場

**調整方案**：
- 立即降低倉位到1%
- 檢查MA排列，如果混亂則暫停交易
- 檢查ATR比值，如果過高(<0.7)則盤整，停止交易
- 等待趨勢重新形成

## 實戰交易規則

### 進場前檢查清單

每次準備交易前，必須確認：

```
□ 均線排列是否清晰？(不能是MA糾纏)
□ 進場點是否在支撐/阻力附近？
□ 成交量是否明顯放大？
□ MACD/RSI是否真實背離？
□ 前一個交易結果？(連虧>2筆則停止)
□ 市場流動性是否充足？(小幣種避免)
```

### 出場規則

**絕對規則**（必須執行）：
- 觸及止損點 → 立即平倉
- 觸及止盈點 → 立即平倉
- 連續虧損達限制 → 停止交易

**彈性規則**（可考慮）：
- 大K線（10倍ATR）反向 → 立即平倉
- MA形成死叉 → 減半平倉
- 趨勢突然反轉 → 平倉1/3

### 日誌記錄範本

每筆交易完成後記錄：

```
交易日期：2024-XX-XX
進場方向：多/空
進場點：$XXXX.XX
止損點：$XXXX.XX
止盈點：$XXXX.XX

進場信號：
  □ MA排列 □ MACD金叉 □ RSI穿越 □ 成交量 □ 背離

執行結果：
  [] 止盈達成（獲利：$XXX）
  [] 止損觸發（虧損：$XXX）
  [] 手動平倉（原因：___）

反思：
  - 進場理由是否充分？
  - 市場環境是否符合預期？
  - 有無滑點/執行延遲？
```

## 常見問題

### Q1：為什麼有時候會連續虧損？

A：這是正常現象。
- 盤整期：MA混亂時，信號勝率下降
- 黑天鵝事件：市場突發新聞導致止損被觸發
- 參數偏差：當前市場環境與參數不匹配

**對策**：
1. 檢查是否進入盤整（ATR比值<0.8）
2. 降低倉位到1%風險
3. 等待MA重新排列再恢復

### Q2：應該用什麼交易對測試？

A：推薦測試順序：
1. **最佳**：BTC/USDT, ETH/USDT （流動性最好）
2. **次佳**：SOL, MATIC, AVAX （中等流動性）
3. **避免**：小幣種、新幣種（流動性不足、容易被操縱）

### Q3：如何判斷參數是否過度優化？

A：檢查以下信號：
- 勝率>75% 且獲利因子>3.0 → 過度優化機率高
- 回測與實盤績效相差>30% → 參數不穩健
- 改變參數±10%後績效崩潰 → 過度擬合

**建議**：
- 用參數最寬鬆的版本進行實盤
- 定期(每月)重新評估參數
- 不要每週都改參數

### Q4：初始資金$1000太小了嗎？

A：可行，但有限制。

| 資金 | 優點 | 缺點 |
|------|------|------|
| $1000 | 風險小、適合練習 | 風險額度$20很小，滑點影響大 |
| $5000 | 風險額度適中($100) | 初始虧損影響百分比大 |
| $10000+ | 倉位靈活、能抗震 | 風險暴露大 |

**建議**：先用$1000紙上模擬，確認策略可行再增加資金。

## 免責聲明

本策略基於歷史數據回測，並不保證未來表現。

**重要提醒**：
- 過去表現≠未來收益
- 虛擬貨幣市場24小時交易，風險極高
- 務必了解風險後才進行交易
- 本策略僅供學習參考，不構成投資建議
- 使用本策略產生的任何虧損由交易者自行承擔

## 貢獻與反饋

如發現bug或有改進建議，歡迎提出Issue或Pull Request。

## 許可證

MIT License - 自由使用，但需註明出處。

---

**最後更新**：2026年1月16日
**版本**：1.0 (Stable)
